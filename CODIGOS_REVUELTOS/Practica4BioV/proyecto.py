from cv2 import *
import serial
import time

def led(var):
	switcher={
		0:	arduino.write(b'000'),
		1:	arduino.write(b'001'),
		2:	arduino.write(b'002'),
		3:	arduino.write(b'003'),
		4:	arduino.write(b'004'),
		5:	arduino.write(b'005'),
		6:	arduino.write(b'006'),
		7:	arduino.write(b'007'),
		8:	arduino.write(b'008'),
		9:	arduino.write(b'009'),
		10:	arduino.write(b'010'),
		11:	arduino.write(b'011'),
		12:	arduino.write(b'012'),
		13:	arduino.write(b'013'),
		14:	arduino.write(b'014'),
		15:	arduino.write(b'015'),
		16:	arduino.write(b'016'),
		17:	arduino.write(b'017'),
		18:	arduino.write(b'018'),
		19:	arduino.write(b'019'),
		20:	arduino.write(b'020'),
		21:	arduino.write(b'021'),
		22:	arduino.write(b'022'),
		23:	arduino.write(b'023'),
		24:	arduino.write(b'024'),
		25:	arduino.write(b'025'),
		26:	arduino.write(b'026'),
		27:	arduino.write(b'027'),
		28:	arduino.write(b'028'),
		29:	arduino.write(b'029'),
		30:	arduino.write(b'030'),
		31:	arduino.write(b'031'),
		32:	arduino.write(b'032'),
		33:	arduino.write(b'033'),
		34:	arduino.write(b'034'),
		35:	arduino.write(b'035'),
		36:	arduino.write(b'036'),
		37:	arduino.write(b'037'),
		38:	arduino.write(b'038'),
		39:	arduino.write(b'039'),
		40:	arduino.write(b'040'),
		41:	arduino.write(b'041'),
		42:	arduino.write(b'042'),
		43:	arduino.write(b'043'),
		44:	arduino.write(b'044'),
		45:	arduino.write(b'045'),
		46:	arduino.write(b'046'),
		47:	arduino.write(b'047'),
		48:	arduino.write(b'048'),
		49:	arduino.write(b'049'),
		50:	arduino.write(b'050'),
		51:	arduino.write(b'051'),
		52:	arduino.write(b'052'),
		53:	arduino.write(b'053'),
		54:	arduino.write(b'054'),
		55:	arduino.write(b'055'),
		56:	arduino.write(b'056'),
		57:	arduino.write(b'057'),
		58:	arduino.write(b'058'),
		59:	arduino.write(b'059'),
		60:	arduino.write(b'060'),
		61:	arduino.write(b'061'),
		62:	arduino.write(b'062'),
		63:	arduino.write(b'063'),
		64:	arduino.write(b'064'),
		65:	arduino.write(b'065'),
		66:	arduino.write(b'066'),
		67:	arduino.write(b'067'),
		68:	arduino.write(b'068'),
		69:	arduino.write(b'069'),
		70:	arduino.write(b'070'),
		71:	arduino.write(b'071'),
		72:	arduino.write(b'072'),
		73:	arduino.write(b'073'),
		74:	arduino.write(b'074'),
		75:	arduino.write(b'075'),
		76:	arduino.write(b'076'),
		77:	arduino.write(b'077'),
		78:	arduino.write(b'078'),
		79:	arduino.write(b'079'),
		80:	arduino.write(b'080'),
		81:	arduino.write(b'081'),
		82:	arduino.write(b'082'),
		83:	arduino.write(b'083'),
		84:	arduino.write(b'084'),
		85:	arduino.write(b'085'),
		86:	arduino.write(b'086'),
		87:	arduino.write(b'087'),
		88:	arduino.write(b'088'),
		89:	arduino.write(b'089'),
		90:	arduino.write(b'090'),
		91:	arduino.write(b'091'),
		92:	arduino.write(b'092'),
		93:	arduino.write(b'093'),
		94:	arduino.write(b'094'),
		95:	arduino.write(b'095'),
		96:	arduino.write(b'096'),
		97:	arduino.write(b'097'),
		98:	arduino.write(b'098'),
		99:	arduino.write(b'099'),
		100:	arduino.write(b'100'),
		100:	arduino.write(b'100'),
		101:	arduino.write(b'101'),
		102:	arduino.write(b'102'),
		103:	arduino.write(b'103'),
		104:	arduino.write(b'104'),
		105:	arduino.write(b'105'),
		106:	arduino.write(b'106'),
		107:	arduino.write(b'107'),
		108:	arduino.write(b'108'),
		109:	arduino.write(b'109'),
		110:	arduino.write(b'110'),
		111:	arduino.write(b'111'),
		112:	arduino.write(b'112'),
		113:	arduino.write(b'113'),
		114:	arduino.write(b'114'),
		115:	arduino.write(b'115'),
		116:	arduino.write(b'116'),
		117:	arduino.write(b'117'),
		118:	arduino.write(b'118'),
		119:	arduino.write(b'119'),
		120:	arduino.write(b'120'),
		121:	arduino.write(b'121'),
		122:	arduino.write(b'122'),
		123:	arduino.write(b'123'),
		124:	arduino.write(b'124'),
		125:	arduino.write(b'125'),
		126:	arduino.write(b'126'),
		127:	arduino.write(b'127'),
		128:	arduino.write(b'128'),
		129:	arduino.write(b'129'),
		130:	arduino.write(b'130'),
		131:	arduino.write(b'131'),
		132:	arduino.write(b'132'),
		133:	arduino.write(b'133'),
		134:	arduino.write(b'134'),
		135:	arduino.write(b'135'),
		136:	arduino.write(b'136'),
		137:	arduino.write(b'137'),
		138:	arduino.write(b'138'),
		139:	arduino.write(b'139'),
		140:	arduino.write(b'140'),
		141:	arduino.write(b'141'),
		142:	arduino.write(b'142'),
		143:	arduino.write(b'143'),
		144:	arduino.write(b'144'),
		145:	arduino.write(b'145'),
		146:	arduino.write(b'146'),
		147:	arduino.write(b'147'),
		148:	arduino.write(b'148'),
		149:	arduino.write(b'149'),
		150:	arduino.write(b'150'),
		151:	arduino.write(b'151'),
		152:	arduino.write(b'152'),
		153:	arduino.write(b'153'),
		154:	arduino.write(b'154'),
		155:	arduino.write(b'155'),
		156:	arduino.write(b'156'),
		157:	arduino.write(b'157'),
		158:	arduino.write(b'158'),
		159:	arduino.write(b'159'),
		160:	arduino.write(b'160'),
		161:	arduino.write(b'161'),
		162:	arduino.write(b'162'),
		163:	arduino.write(b'163'),
		164:	arduino.write(b'164'),
		165:	arduino.write(b'165'),
		166:	arduino.write(b'166'),
		167:	arduino.write(b'167'),
		168:	arduino.write(b'168'),
		169:	arduino.write(b'169'),
		170:	arduino.write(b'170'),
		171:	arduino.write(b'171'),
		172:	arduino.write(b'172'),
		173:	arduino.write(b'173'),
		174:	arduino.write(b'174'),
		175:	arduino.write(b'175'),
		176:	arduino.write(b'176'),
		177:	arduino.write(b'177'),
		178:	arduino.write(b'178'),
		179:	arduino.write(b'179'),
		180:	arduino.write(b'180'),
		181:	arduino.write(b'181'),
		182:	arduino.write(b'182'),
		183:	arduino.write(b'183'),
		184:	arduino.write(b'184'),
		185:	arduino.write(b'185'),
		186:	arduino.write(b'186'),
		187:	arduino.write(b'187'),
		188:	arduino.write(b'188'),
		189:	arduino.write(b'189'),
		190:	arduino.write(b'190'),
		191:	arduino.write(b'191'),
		192:	arduino.write(b'192'),
		193:	arduino.write(b'193'),
		194:	arduino.write(b'194'),
		195:	arduino.write(b'195'),
		196:	arduino.write(b'196'),
		197:	arduino.write(b'197'),
		198:	arduino.write(b'198'),
		199:	arduino.write(b'199'),
		200:	arduino.write(b'200'),
		201:	arduino.write(b'201'),
		202:	arduino.write(b'202'),
		203:	arduino.write(b'203'),
		204:	arduino.write(b'204'),
		205:	arduino.write(b'205'),
		206:	arduino.write(b'206'),
		207:	arduino.write(b'207'),
		208:	arduino.write(b'208'),
		209:	arduino.write(b'209'),
		210:	arduino.write(b'210'),
		211:	arduino.write(b'211'),
		212:	arduino.write(b'212'),
		213:	arduino.write(b'213'),
		214:	arduino.write(b'214'),
		215:	arduino.write(b'215'),
		216:	arduino.write(b'216'),
		217:	arduino.write(b'217'),
		218:	arduino.write(b'218'),
		219:	arduino.write(b'219'),
		220:	arduino.write(b'220'),
		221:	arduino.write(b'221'),
		222:	arduino.write(b'222'),
		223:	arduino.write(b'223'),
		224:	arduino.write(b'224'),
		225:	arduino.write(b'225'),
		226:	arduino.write(b'226'),
		227:	arduino.write(b'227'),
		228:	arduino.write(b'228'),
		229:	arduino.write(b'229'),
		230:	arduino.write(b'230'),
		231:	arduino.write(b'231'),
		232:	arduino.write(b'232'),
		233:	arduino.write(b'233'),
		234:	arduino.write(b'234'),
		235:	arduino.write(b'235'),
		236:	arduino.write(b'236'),
		237:	arduino.write(b'237'),
		238:	arduino.write(b'238'),
		239:	arduino.write(b'239'),
		240:	arduino.write(b'240'),
		241:	arduino.write(b'241'),
		242:	arduino.write(b'242'),
		243:	arduino.write(b'243'),
		244:	arduino.write(b'244'),
		245:	arduino.write(b'245'),
		246:	arduino.write(b'246'),
		247:	arduino.write(b'247'),
		248:	arduino.write(b'248'),
		249:	arduino.write(b'249'),
		250:	arduino.write(b'250'),
		251:	arduino.write(b'251'),
		252:	arduino.write(b'252'),
		253:	arduino.write(b'253'),
		254:	arduino.write(b'254'),
		255:	arduino.write(b'255'),
	}


namedWindow("webcam");
vc = VideoCapture(1);

while True:
    next, frame = vc.read();
    frame = cv2.drawMarker(frame, (300,200), (0,0,255), markerType=cv2.MARKER_TILTED_CROSS, markerSize=20, thickness=2, line_type=cv2.LINE_AA)
    #(200,250)
    #(400,250)
    imshow("webcam", frame);
    if waitKey(50) >= 0:
        break;

    pixel1b, pixel1g, pixel1r= frame[300][200];
    
    rojo = pixel1r;
    verde = pixel1g;
    azul = pixel1b;

    print("Rojo: ",rojo, " Verde: ", verde, " Azul: ",azul);

    arduino = serial.Serial("COM14", 9600);
    time.sleep(2);
    arduino.write(b'\r');
    led(rojo);
    time.sleep(2);
    led(verde);
    time.sleep(2);
    led(azul);
    arduino.write(b'\n');
    arduino.close();
	